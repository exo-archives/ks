
h1. KS 2.0 extension Installation Instruction guide

h1. Objectives

This install guide will help you to deploy and configuration for ks 2.0 extension to an existing Gatein portal on Jboss or Tomcat:



*Requirements*
* Gate in 3.0.0-Beta05 or higher deployed to Jboss 5.1.0 GA or Tomcat 6.0.16
* Binary bundle of KS 2.0
** *Jboss* 
*** - gatein.ear
** *Tomcat*
*** - exo.ks.component.bbcode-2.0.0-Alpha03.jar
*** - exo.ks.component.common-2.0.0-Alpha03.jar
*** - exo.ks.component.rendering-2.0.0-Alpha03.jar
*** - exo.ks.demo.config-2.0.0-Alpha03.jar
*** - exo.ks.eXoApplication.common-2.0.0-Alpha03.jar
*** - exo.ks.eXoApplication.faq.service-2.0.0-Alpha03.jar
*** - exo.ks.eXoApplication.forum.service-2.0.0-Alpha03.jar
*** - exo.ks.extension.config-2.0.0-Alpha03.jar
*** - cometd-ksdemo.war
*** - faq.war
*** - forum.war
*** - ksdemo.war
*** - ks-extension.war
*** - ksResources.war
*** - rest-ksdemo.war
** Dependencies are needed for KS (comes from platform project)
*** - exo.platform.commons.comet.service-3.0.0-Alpha01.jar
*** - fck.war 

+Note:+ You can checkout KS resource from _svn.exoplatform.org_ to build the binaries by your self or download from http://download.forge.objectweb.org/exoplatform

h2. Install binaries

* *Jboss server*
** Copy the gatein.ear to _../jboss/server/default/deploy folder_

* *Tomcat server*
** Copy the jars file(listing above) to _../lib folder_
** Copy the wars file(listing above) to _../webapps folder_

h2. Product configurations
There are some extensible configuration in KS product, that allow more flexible with user to configure their product as Email notification service, default access Roles and default layout for FAQ application

* *Email service configuration*
Allow user can set an email address as a default mail box of KS to send notification during running time

_../webapps/ks-extension/WEB-INF/ks-extension/ks/ks-configuration.xml_

{code:xml}
<component>
		<key>org.exoplatform.services.mail.MailService</key>
		<type>org.exoplatform.services.mail.impl.MailServiceImpl</type>
			<init-params>
				<properties-param>
					<name>config</name>
					<property name="mail.smtp.auth.username" value="someuser" />
					<property name="mail.smtp.auth.password" value="somepassword" />
					<property name="mail.smtp.host" value="smtp.gmail.com" />
					<property name="mail.smtp.port" value="465" />
		 			<property name="mail.smtp.starttls.enable" value="true" />
					<property name="mail.smtp.auth" value="true" />
					<property name="mail.smtp.debug" value="false" />
					<property name="mail.smtp.socketFactory.port" value="465" />
					<property name="mail.smtp.socketFactory.class" value="javax.net.ssl.SSLSocketFactory" />
					<property name="mail.smtp.socketFactory.fallback" value="false" />
				</properties-param>
			</init-params>
	</component>
{code}


* *Role configuration*
Allow user can set the default role for users, groups or memberships

** *With Forum application*

~~../webapps/ks-extension/WEB-INF/ks-extension/ks/forum/roles-configuration.xml~~

{code:xml}
<external-component-plugins>
    <target-component>org.exoplatform.forum.service.ForumService</target-component>      
    <component-plugin>
      <name>add.role.rules.plugin</name>
      <set-method>addRolePlugin</set-method>
      <type>org.exoplatform.ks.common.conf.RoleRulesPlugin</type>
      <description>add role rules</description>
      <init-params>
        <value-param>
          <name>role</name>
          <description>name of the role</description>
          <value>ADMIN</value>
        </value-param>
        <values-param>
          <name>rules</name>
          <description>rules of the role</description>
          <value>root</value>          
          <!--value>*:/somegroup/somesubgroup</value-->
          <!--value>manager:/somegroup/someothergroup</value-->
        </values-param>
      </init-params>
    </component-plugin>
    </external-component-plugins>
{code}

** *With FAQ application*

_../webapps/ks-extension/WEB-INF/ks-extension/ks/faq/roles-configuration.xml_

{code:xml}
<external-component-plugins>
    <target-component>org.exoplatform.faq.service.FAQService</target-component>		
    <component-plugin>
      <name>add.role.rules.plugin</name>
      <set-method>addRolePlugin</set-method>
      <type>org.exoplatform.ks.common.conf.RoleRulesPlugin</type>
      <description>add role rules</description>
      <init-params>
        <value-param>
          <name>role</name>
          <description>name of the role</description>
          <value>ADMIN</value>
        </value-param>        
        <values-param>
          <name>rules</name>
          <description>rules of the role</description>
          <value>root</value>
          <!-value>*:/somegroup/somesubgroup</value->
          <!-value>manager:/somegroup/someothergroup</value->
        </values-param>
      </init-params>
    </component-plugin>
</external-component-plugins>  
{code}


* *FAQ application layout template configuration*

~~../webapps/ks-extension/WEB-INF/ks-extension/ks/faq/templates-configuration.xml~~

{code:xml}
<external-component-plugins>
  <target-component>org.exoplatform.faq.service.FAQService</target-component>
  <component-plugin>
    <name>faq.default.template</name>
    <set-method>addTemplatePlugin</set-method>
    <type>org.exoplatform.faq.service.TemplatePlugin</type>
    <init-params>
      <value-param>
        <name>viewerTemplate</name>
        <value>war:/ks-extension/ks/faq/templates/FAQViewerPortlet.gtmpl</value>
      </value-param>
    </init-params>
  </component-plugin>
</external-component-plugins>  
{code}

* *BBCode configuration*
By default KS have many default BBcode tags as +I+, +U+, +B+, +COLOR+,... User can also predefine others BBcode tags(and also can define at the running time)

{code:xml}
 <external-component-plugins>
    <target-component>org.exoplatform.ks.bbcode.api.BBCodeService</target-component>   
    <component-plugin>
      <name>forum.default.bbcodes</name>
      <set-method>registerBBCodePlugin</set-method>
      <type>org.exoplatform.ks.bbcode.spi.BBCodePlugin</type>
      <description>default supported BBCodes</description>
      <init-params>
        <object-param>
          <name>I</name>
          <description>set text in italic</description>
          <object type="org.exoplatform.ks.bbcode.spi.BBCodeData">
            <field name="tagName">
              <string>I</string>
            </field>
            <field name="replacement">
              <string><![CDATA[<i|{param}</i|]]></string>
            </field>
            <field name="description">
              <string>Set text in italic</string>
            </field>
            <field name="example">
              <string>[I]This text is italic[/I]</string>
            </field>
            <field name="isOption">
              <string>false</string>
            </field>
            <field name="isActive">
              <string>true</string>
            </field>
          </object> 
        </object-param>

        ..................
      </init-params>
    </component-plugin>
  </external-component-plugins> 
{code}

_Congratulations, you have successfully installed  eXo Knowledge Suite!_

